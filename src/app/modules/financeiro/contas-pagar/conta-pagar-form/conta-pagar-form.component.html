<div class="page-header">
  <h1>{{ contaId ? 'Editar' : 'Nova' }} Conta a Pagar</h1>
  <button class="btn btn-secondary" (click)="cancelar()">Cancelar</button>
</div>

<div *ngIf="alertMessage" class="alert alert-{{alertType}}">
  {{ alertMessage }}
</div>

<div class="card">
  <form [formGroup]="contaForm" (ngSubmit)="salvar()">
    <div class="form-row">
      <div class="form-group">
        <label>Descrição *</label>
        <input type="text" formControlName="descricao" class="form-control" />
        <span *ngIf="contaForm.get('descricao')?.invalid && contaForm.get('descricao')?.touched" class="error-message">
          Descrição é obrigatória
        </span>
      </div>
      <div class="form-group">
        <label>Categoria *</label>
        <select formControlName="categoria" class="form-control">
          <option value="">Selecione uma categoria</option>
          <option *ngFor="let cat of categorias" [value]="cat">{{ cat }}</option>
        </select>
        <span *ngIf="contaForm.get('categoria')?.invalid && contaForm.get('categoria')?.touched" class="error-message">
          Categoria é obrigatória
        </span>
      </div>
    </div>

    <div class="form-row">
      <div class="form-group">
        <label>Valor (R$) *</label>
        <input type="number" formControlName="valor" class="form-control" step="0.01" min="0.01" required />
        <span *ngIf="contaForm.get('valor')?.invalid && contaForm.get('valor')?.touched" class="error-message">
          Valor é obrigatório e deve ser maior que zero
        </span>
      </div>
      <div class="form-group">
        <label>Data de Vencimento *</label>
        <input type="date" formControlName="data_vencimento" class="form-control" />
        <span *ngIf="contaForm.get('data_vencimento')?.invalid && contaForm.get('data_vencimento')?.touched" class="error-message">
          Data de vencimento é obrigatória
        </span>
      </div>
    </div>

    <div class="form-row">
      <div class="form-group">
        <label>Status</label>
        <select formControlName="status" class="form-control">
          <option value="pendente">Pendente</option>
          <option value="pago">Pago</option>
          <option value="vencido">Vencido</option>
        </select>
      </div>
      <div class="form-group" *ngIf="contaForm.get('status')?.value === 'pago'">
        <label>Data de Pagamento</label>
        <input type="date" formControlName="data_pagamento" class="form-control" />
      </div>
    </div>

    <div class="form-row" *ngIf="contaForm.get('status')?.value === 'pago'">
      <div class="form-group">
        <label>Forma de Pagamento</label>
        <select formControlName="forma_pagamento" class="form-control">
          <option value="">Selecione a forma de pagamento</option>
          <option value="dinheiro">Dinheiro</option>
          <option value="cartao">Cartão</option>
          <option value="pix">PIX</option>
          <option value="transferencia">Transferência</option>
        </select>
      </div>
    </div>

    <div class="form-group">
      <label>Observações</label>
      <textarea formControlName="observacoes" class="form-control" rows="4"></textarea>
    </div>

    <div class="form-actions">
      <button type="button" class="btn btn-secondary" (click)="cancelar()" [disabled]="loading">
        Cancelar
      </button>
      <button type="submit" class="btn btn-primary" [disabled]="loading || contaForm.invalid">
        {{ loading ? 'Salvando...' : (contaId ? 'Atualizar' : 'Salvar') }}
      </button>
    </div>
  </form>
</div>

