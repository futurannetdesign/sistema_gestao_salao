<div class="page-header">
  <h1>üîê Migrar Senhas para Hash</h1>
</div>

<div *ngIf="alertMessage" class="alert alert-{{alertType}}">
  {{ alertMessage }}
</div>

<div *ngIf="!authService.isAdmin()" class="alert alert-danger">
  Apenas administradores podem migrar senhas!
</div>

<div *ngIf="authService.isAdmin() && !loading" class="card">
  <div class="migracao-info">
    <h3>Status da Migra√ß√£o</h3>
    <p><strong>Total de usu√°rios:</strong> {{ usuarios.length }}</p>
    <p><strong>Usu√°rios com senha em texto plano:</strong> {{ usuariosComSenhaPlana.length }}</p>
    <p><strong>Usu√°rios com senha hasheada:</strong> {{ usuarios.length - usuariosComSenhaPlana.length }}</p>
  </div>

  <div *ngIf="usuariosComSenhaPlana.length > 0" class="alert alert-warning">
    <strong>‚ö†Ô∏è Aten√ß√£o:</strong> Existem {{ usuariosComSenhaPlana.length }} usu√°rio(s) com senha em texto plano.
    <br><br>
    <strong>Migra√ß√£o Autom√°tica:</strong> As senhas ser√£o migradas automaticamente para hash quando cada usu√°rio fizer login pela primeira vez ap√≥s a implementa√ß√£o do hash.
    <br><br>
    <strong>Como funciona:</strong>
    <ul style="margin: 10px 0; padding-left: 20px;">
      <li>O sistema detecta senhas em texto plano automaticamente</li>
      <li>No primeiro login, a senha √© verificada e migrada para hash</li>
      <li>O processo √© transparente para o usu√°rio</li>
      <li>N√£o √© necess√°rio migrar manualmente</li>
    </ul>
  </div>

  <div *ngIf="usuariosComSenhaPlana.length === 0" class="alert alert-success">
    <strong>‚úÖ Tudo certo!</strong> Todas as senhas est√£o hasheadas.
  </div>

  <div *ngIf="usuariosComSenhaPlana.length > 0" class="usuarios-lista">
    <h3>Usu√°rios com Senha em Texto Plano</h3>
    <table class="table">
      <thead>
        <tr>
          <th>ID</th>
          <th>Nome</th>
          <th>Email</th>
          <th>Perfil</th>
          <th>Status</th>
          <th>A√ß√µes</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let usuario of usuariosComSenhaPlana">
          <td>{{ usuario.id }}</td>
          <td>{{ usuario.nome }}</td>
          <td>{{ usuario.email }}</td>
          <td>
            <span class="badge" [class.badge-success]="usuario.perfil === 'admin'">
              {{ usuario.perfil === 'admin' ? 'Admin' : 'Funcion√°rio' }}
            </span>
          </td>
          <td>
            <span class="badge badge-warning">Senha em Texto Plano</span>
          </td>
          <td>
            <span class="badge badge-info">Migra√ß√£o Autom√°tica</span>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

<div *ngIf="loading" class="loading">
  Carregando usu√°rios...
</div>

