<div class="page-header">
  <h1>{{ produtoId ? 'Editar' : 'Novo' }} Produto</h1>
  <button class="btn btn-secondary" (click)="cancelar()">Cancelar</button>
</div>

<div *ngIf="alertMessage" class="alert alert-{{alertType}}">
  {{ alertMessage }}
</div>

<div class="card">
  <form [formGroup]="produtoForm" (ngSubmit)="salvar()">
    <div class="form-row">
      <div class="form-group">
        <label>Nome do Produto *</label>
        <input type="text" formControlName="nome" class="form-control" />
        <span *ngIf="produtoForm.get('nome')?.invalid && produtoForm.get('nome')?.touched" class="error-message">
          Nome é obrigatório
        </span>
      </div>
      <div class="form-group">
        <label>Categoria</label>
        <input type="text" formControlName="categoria" class="form-control" placeholder="Ex: Shampoo, Tinta, Creme" />
      </div>
    </div>

    <div class="form-group">
      <label>Descrição</label>
      <textarea formControlName="descricao" class="form-control" rows="3"></textarea>
    </div>

    <div class="form-row">
      <div class="form-group">
        <label>Quantidade Atual *</label>
        <input type="number" formControlName="quantidade_atual" class="form-control" min="0" />
        <span *ngIf="produtoForm.get('quantidade_atual')?.invalid && produtoForm.get('quantidade_atual')?.touched" class="error-message">
          Quantidade deve ser maior ou igual a zero
        </span>
      </div>
      <div class="form-group">
        <label>Quantidade Mínima *</label>
        <input type="number" formControlName="quantidade_minima" class="form-control" min="0" />
        <span *ngIf="produtoForm.get('quantidade_minima')?.invalid && produtoForm.get('quantidade_minima')?.touched" class="error-message">
          Quantidade mínima deve ser maior ou igual a zero
        </span>
      </div>
      <div class="form-group">
        <label>Unidade de Medida</label>
        <select formControlName="unidade_medida" class="form-control">
          <option *ngFor="let unidade of unidadesMedida" [value]="unidade">{{ unidade }}</option>
        </select>
      </div>
    </div>

    <div class="form-row">
      <div class="form-group">
        <label>Valor Unitário (R$)</label>
        <input type="number" formControlName="valor_unitario" class="form-control" step="0.01" min="0" />
      </div>
      <div class="form-group">
        <label>Fornecedor</label>
        <input type="text" formControlName="fornecedor" class="form-control" />
      </div>
    </div>

    <div class="form-group">
      <label>
        <input type="checkbox" formControlName="ativo" />
        Produto ativo
      </label>
    </div>

    <div class="form-actions">
      <button type="button" class="btn btn-secondary" (click)="cancelar()" [disabled]="loading">
        Cancelar
      </button>
      <button type="submit" class="btn btn-primary" [disabled]="loading || produtoForm.invalid">
        {{ loading ? 'Salvando...' : (produtoId ? 'Atualizar' : 'Salvar') }}
      </button>
    </div>
  </form>
</div>

